# Bar plots for most frequent taxa----
# create vector with names of most frequent taxa, extract those taxa from phyloseq object
top20 <- names(sort(taxa_sums(ps), decreasing=TRUE))[1:20]
ps.top20 <- prune_taxa(top20, ps1.trans)
# create dataframe for plotting
df.top20 <- psmelt(ps.top20)
table(df.top20$Genus)
# Bar plots for most frequent taxa----
# create vector with names of most frequent taxa, extract those taxa from phyloseq object
top20 <- names(sort(taxa_sums(ps), decreasing=TRUE))[1:15]
ps.top20 <- prune_taxa(top20, ps1.trans)
# create dataframe for plotting
df.top20 <- psmelt(ps.top20)
table(df.top20$Genus)
# Bar plots for most frequent taxa----
# create vector with names of most frequent taxa, extract those taxa from phyloseq object
top20 <- names(sort(taxa_sums(ps), decreasing=TRUE))[1:16]
ps.top20 <- prune_taxa(top20, ps1.trans)
# create dataframe for plotting
df.top20 <- psmelt(ps.top20)
table(df.top20$Genus)
# Bar plots for most frequent taxa----
# create vector with names of most frequent taxa, extract those taxa from phyloseq object
top20 <- names(sort(taxa_sums(ps), decreasing=TRUE))[1:17]
ps.top20 <- prune_taxa(top20, ps1.trans)
# create dataframe for plotting
df.top20 <- psmelt(ps.top20)
table(df.top20$Genus)
names(table(df.top20$Genus))
names(table(df.top20$Family))
names(table(df.top20$Genus))
load("~/Documents/WD/quillmites/all/R/16S.V4.quillmites_NEW.RData")
library(decontam)
citation(decontam)
?citation(decontam)
citation(package="decontam")
citation(package="vegan")
rarefy_even_depth(ps.1, rngseed = 6366)
library("phyloseq", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.4")
rarefy_even_depth(ps.1, rngseed = 6366)
ps.1
track
(track)[track$nonchim<3500]
low_covered
track
track$nonchim
sort(track$nonchim)
# Now, check if very low covered taxa are present:
hist(track$nonchim, breaks=80)
axis(side=1, at=seq(0,5000,500), labels=seq(0,5000,500))
ggplot(plotdf1, aes(x=Spiro.pres, y=wol.rel, color=Spiro.pres))+
geom_boxplot()+
geom_point(size = 2, alpha = 0.8, position = position_jitter(width = 0.3))+
theme_light()+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Spiroplasma")+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12),
legend.position="none")+
scale_colour_tableau(palette="colorblind10")
library("ggplot2", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.4")
ggplot(plotdf1, aes(x=Spiro.pres, y=wol.rel, color=Spiro.pres))+
geom_boxplot()+
geom_point(size = 2, alpha = 0.8, position = position_jitter(width = 0.3))+
theme_light()+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Spiroplasma")+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12),
legend.position="none")+
scale_colour_tableau(palette="colorblind10")
plotdf1 <- filter(plotdf,wol.rel>=1)
ggplot(plotdf1, aes(x=Spiro.pres, y=wol.rel, color=Spiro.pres))+
geom_boxplot()+
geom_point(size = 2, alpha = 0.8, position = position_jitter(width = 0.3))+
theme_light()+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Spiroplasma")+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12),
legend.position="none")+
scale_colour_tableau(palette="colorblind10")
library("tidyverse", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.4")
plotdf1 <- filter(plotdf,wol.rel>=1)
plotdf$spiro.rel <- plotdf$Spiro.prop/plotdf$nowol.prop*100
df.spiro <- df.trans %>% filter(Genus=="Spiroplasma") %>%
group_by(id, species, host.species) %>% summarise(Spiro.prop=sum(Abundance))
df.spiro$Spiro.pres <- NA
df.spiro[df.spiro$Spiro.prop>0.01,]$Spiro.pres <- "present"
df.spiro[df.spiro$Spiro.prop<=0.01,]$Spiro.pres <- "absent"
plotdf <- df.spiro
df.wolb <- df.trans %>% filter(Genus=="Wolbachia") %>%
group_by(id, species, host.species) %>% summarize(Wolb.prop=sum(Abundance))
plotdf$wolb.prop <- df.wolb$Wolb.prop
plotdf$Wolb.pres <- NA
plotdf[plotdf$wolb.prop>0.01,]$Wolb.pres <- "present"
plotdf[plotdf$wolb.prop<=0.01,]$Wolb.pres <- "absent"
df.nospiro <- df.trans %>% filter(Genus!="Spiroplasma") %>%
group_by(id, species, host.species) %>% summarize(nospiro.prop=sum(Abundance))
plotdf$nospiro.prop <- df.nospiro$nospiro.prop
df.nowol <- df.trans %>% filter(Genus!="Wolbachia") %>%
group_by(id, species, host.species) %>% summarize(nowol.prop=sum(Abundance))
plotdf$nowol.prop <- df.nowol$nowol.prop
plotdf$spiro.rel <- plotdf$Spiro.prop/plotdf$nowol.prop*100
plotdf$wol.rel <- plotdf$wolb.prop/plotdf$nospiro.prop*100
plotdf1 <- filter(plotdf,wol.rel>=1)
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel))+
geom_point(size=3,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Spiroplasma")+
xlab(label="Relative abundance of Wolbachia")
plotdf2 <- filter(plotdf,spiro.rel>=1)
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel))+
geom_point(size=3,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Spiroplasma")+
xlab(label="Relative abundance of Wolbachia")
ggplot(plotdf1, aes(x=Spiro.pres, y=wol.rel, color=Spiro.pres))+
geom_boxplot()+
geom_point(size = 2, alpha = 0.8, position = position_jitter(width = 0.3))+
theme_light()+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Spiroplasma")+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12),
legend.position="none")+
scale_colour_tableau(palette="colorblind10")
library("ggthemes", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.4")
ggplot(plotdf1, aes(x=Spiro.pres, y=wol.rel, color=Spiro.pres))+
geom_boxplot()+
geom_point(size = 2, alpha = 0.8, position = position_jitter(width = 0.3))+
theme_light()+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Spiroplasma")+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12),
legend.position="none")+
scale_colour_tableau(palette="colorblind10")
plotdf2 <- filter(plotdf,spiro.rel>=0.5)
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel))+
geom_point(size=4,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Spiroplasma")+
xlab(label="Relative abundance of Wolbachia")
plotdf2 <- filter(plotdf,spiro.rel>0)
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel))+
geom_point(size=4,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Spiroplasma")+
xlab(label="Relative abundance of Wolbachia")
plotdf2 <- filter(plotdf,spiro.rel>0.5)
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel))+
geom_point(size=4,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Spiroplasma")+
xlab(label="Relative abundance of Wolbachia")
plotdf1 <- filter(plotdf,wol.rel>=0.5)
ggplot(plotdf1, aes(x=Spiro.pres, y=wol.rel, color=Spiro.pres))+
geom_boxplot()+
geom_point(size = 2, alpha = 0.8, position = position_jitter(width = 0.3))+
theme_light()+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Spiroplasma")+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12),
legend.position="none")+
scale_colour_tableau(palette="colorblind10")
plotdf1 <- filter(plotdf,wol.rel>=1)
ggplot(plotdf1, aes(x=Spiro.pres, y=wol.rel, color=Spiro.pres))+
geom_boxplot()+
geom_point(size = 2, alpha = 0.8, position = position_jitter(width = 0.3))+
theme_light()+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Spiroplasma")+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12),
legend.position="none")+
scale_colour_tableau(palette="colorblind10")
plotdf2 <- filter(plotdf,spiro.rel>1)
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel))+
geom_point(size=4,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Spiroplasma")+
xlab(label="Relative abundance of Wolbachia")
plotdf2 <- filter(plotdf,spiro.rel>1 & wol.rel>=1)
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel))+
geom_point(size=4,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Spiroplasma")+
xlab(label="Relative abundance of Wolbachia")
plotdf1 <- filter(plotdf,wol.rel>=1 & spiro.rel>=1)
ggplot(plotdf1, aes(x=Spiro.pres, y=wol.rel, color=Spiro.pres))+
geom_boxplot()+
geom_point(size = 2, alpha = 0.8, position = position_jitter(width = 0.3))+
theme_light()+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Spiroplasma")+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12),
legend.position="none")+
scale_colour_tableau(palette="colorblind10")
plotdf1 <- filter(plotdf,wol.rel>=1)
ggplot(plotdf1, aes(x=Spiro.pres, y=wol.rel, color=Spiro.pres))+
geom_boxplot()+
geom_point(size = 2, alpha = 0.8, position = position_jitter(width = 0.3))+
theme_light()+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Spiroplasma")+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12),
legend.position="none")+
scale_colour_tableau(palette="colorblind10")
plotdf2 <- filter(plotdf,spiro.rel>=1)
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel))+
geom_point(size=4,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Spiroplasma")+
xlab(label="Relative abundance of Wolbachia")
plotdf2 <- filter(plotdf,spiro.rel>=1)
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel))+
geom_point(size=4,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Relative abundance of Spiroplasma")
plotdf2
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel))+
geom_point(size=4,color="#39737C", shape=species)+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Relative abundance of Spiroplasma")
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel, shape=species))+
geom_point(size=4,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Relative abundance of Spiroplasma")
plotdf$spiro.rel <- plotdf$Spiro.prop/plotdf$nowol.prop
plotdf$wol.rel <- plotdf$wolb.prop/plotdf$nospiro.prop
plotdf1 <- filter(plotdf,wol.rel>=1)
plotdf1 <- filter(plotdf,wol.rel>=0.01)
ggplot(plotdf1, aes(x=Spiro.pres, y=wol.rel, color=Spiro.pres))+
geom_boxplot()+
geom_point(size = 2, alpha = 0.8, position = position_jitter(width = 0.3))+
theme_light()+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Spiroplasma")+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12),
legend.position="none")+
scale_colour_tableau(palette="colorblind10")
plotdf2 <- filter(plotdf,spiro.rel>=0.01)
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel, shape=species))+
geom_point(size=4,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Relative abundance of Spiroplasma")
plotdf2 <- filter(plotdf,spiro.rel>=0.01)
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel))+
geom_point(size=4,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Relative abundance of Spiroplasma")
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel, shape=stage))+
geom_point(size=4,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Relative abundance of Spiroplasma")
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel, shape=stage1))+
geom_point(size=4,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Relative abundance of Spiroplasma")
plotdf2
df.trans %>% filter(id=plotdf2$id)
df.trans %>% filter(id==plotdf2$id)
plotdf2
plotdf2$id
df.trans %>% filter(id==plotdf2$id) %>% group_by(stage1)
df.trans %>% filter(id==plotdf2$id) %>% group_by(Sample)
df.trans[id==plotdf2$id,]
df.trans[,id==plotdf2$id]
filter(df.trans ,id==plotdf2$id)
filter(df.trans ,id==plotdf2$id)$Sample
filter(df.trans ,id==plotdf2$id)$id
filter(df.trans ,id==plotdf2$id) %>% select(id, stage1, stage2)
filter(df.trans ,id==plotdf2$id) %>% select(id, stage1)
unique(filter(df.trans ,id==plotdf2$id) %>% select(id, stage1))
unique(filter(df.trans ,id==plotdf2$id) %>% select(id, stage1))$stage1
plotdf2
unique(filter(df.trans ,id==plotdf2$id) %>% select(id, stage1))
sort(unique(filter(df.trans ,id==plotdf2$id) %>% select(id, stage1)))
unique(filter(df.trans ,id==plotdf2$id) %>% select(id, stage1))
stagedf <- unique(filter(df.trans ,id==plotdf2$id) %>% select(id, stage1))
stagedf
join(stagedf, plotdf2)
inner_join(stagedf, plotdf2)
inner_join(plotdf2, stagedf)
plotdf2 <- filter(inner_join(plotdf2, stagedf),spiro.rel>=0.01)
ggplot(plotdf2, aes(x=spiro.rel, y=wol.rel, shape=stage1))+
geom_point(size=4,color="#39737C")+
theme_light()+
theme(axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14),
axis.text = element_text(size=12))+
ylab(label="Relative abundance of Wolbachia")+
xlab(label="Relative abundance of Spiroplasma")
# determine which are the significantly different taxa on all levels
filter(KWresults_Genus_host_genus, pvalue.corr<=0.01)
filter(KWresults_Family_host_genus, pvalue.corr<=0.01)
filter(KWresults_Family_species, pvalue.corr<=0.01)
filter(KWresults_Family_species, pvalue.corr<=0.05)
filter(KWresults_Family_species, pvalue.corr<=0.01)
df.wolb
df.trans %>% group_by(species, host.species)
df.trans %>% group_by(species, host.species) %>% summarise()
df.trans %>% group_by(species, host.species) %>% tally()
df.trans %>% group_by(species, host.species) %>% summarize(count = n_distinct(id))
write.table("test.csv", df.trans %>% group_by(species, host.species) %>% summarize(count = n_distinct(id)))
install.packages("rtweet")
require(devtools)
install_github("lchiffon/wordcloud2")
library(tidytext)
install.packages("tidytext")
library(tidytext)
library(dplyr)
library(stringr)
library(rtweet)
library(wordcloud2)
create_token(
app = "wordcloud-app",
consumer_key = "z96ZeSCUJtpmSyn7UJSQ19Ndc",
consumer_secret = "YORx0EVEkDtuTV3PqFBmI8hGyqoUyTB7LCBxsN5kBSGZUbUtNv")
wolb <- search_tweets(
"#Wolbachia2018", include_rts = FALSE
)
wolb
wolb <- search_tweets(
"#wolbachia2018", include_rts = FALSE
)
wolb
wolb <- search_tweets(
"#wolbachia2018", include_rts = FALSE, n=10000
)
wolb
me <- get_timeline(gerth_micha, n=1000)
me <- get_timeline("gerth_micha", n=1000)
me
me <- get_timeline("gerth_micha", n=1000, include_rts = FALSE)
me
wolb <- search_tweets(
"#wolbachia2018", n=10000
)
wolb
#Unnest the words - code via Tidy Text
wolbTable <- wolb %>%
unnest_tokens(word, text)
wolbTable
#remove stop words - aka typically very common words such as "the", "of" etc
data(stop_words)
#remove stop words - aka typically very common words such as "the", "of" etc
data(stop_words)
wolbTable <- wolbTable %>%
anti_join(stop_words)
#do a word count
wolbTable <- wolbTable %>%
count(word, sort = TRUE)
wolbTable
#Remove other nonsense words
hmtTable <-hmtTable %>%
filter(!word %in% c('t.co', 'https', 'amp', 'wolbachia2018', 'watch'))
#Remove other nonsense words
wolbTable <-wolbTable %>%
filter(!word %in% c('t.co', 'https', 'amp', 'wolbachia2018', 'watch'))
wolbTable
wolb <- search_tweets(
"#wolbachia2018", n=10000, include_rts = F
)
#Unnest the words - code via Tidy Text
wolbTable <- wolb %>%
unnest_tokens(word, text)
#remove stop words - aka typically very common words such as "the", "of" etc
data(stop_words)
wolbTable <- wolbTable %>%
anti_join(stop_words)
#do a word count
wolbTable <- wolbTable %>%
count(word, sort = TRUE)
wolbTable
#Remove other nonsense words
wolbTable <-wolbTable %>%
filter(!word %in% c('t.co', 'https', 'amp', 'wolbachia2018', 'watch'))
wolbTable
wordcloud2(wolbTable, size=0.7)
wolbTable
wolb <- search_tweets(
"#wolbachia2018", n=10000, include_rts = F
)
#Unnest the words - code via Tidy Text
wolbTable <- wolb %>%
unnest_tokens(word, text)
#remove stop words - aka typically very common words such as "the", "of" etc
data(stop_words)
wolbTable <- wolbTable %>%
anti_join(stop_words)
#do a word count
wolbTable <- wolbTable %>%
count(word, sort = TRUE)
wolbTable
#Remove other nonsense words
wolbTable <-wolbTable %>%
filter(!word %in% c('t.co', 'https', 'amp', 'watch'))
wordcloud2(wolbTable, size=0.7)
wordcloud2(wolbTable, size=0.7)
wordcloud2(wolbTable, size=0.7)
wordcloud2(wolbTable, size=0.7)
wordcloud2(wolbTable, size=2)
me <- get_timeline("gerth_micha", n=1000, include_rts = FALSE)
#Unnest the words - code via Tidy Text
wolbTable <- me %>%
unnest_tokens(word, text)
#remove stop words - aka typically very common words such as "the", "of" etc
data(stop_words)
wolbTable <- wolbTable %>%
anti_join(stop_words)
#do a word count
wolbTable <- wolbTable %>%
count(word, sort = TRUE)
wolbTable
#Remove other nonsense words
wolbTable <-wolbTable %>%
filter(!word %in% c('t.co', 'https', 'amp', 'watch'))
wordcloud2(wolbTable, size=2)
shiny::runApp('Documents/R/pbplot')
runApp('Documents/R/pbplot')
runApp('Documents/R/pbplot')
runApp('Documents/R/pbplot')
runApp('Documents/R/pbplot')
runApp('Documents/R/pbplot')
runApp('Documents/R/pbplot')
devtools::install_github('andrewsali/shinycssloaders')
library(shinycssloaders)
runApp('Documents/R/pbplot')
install.packages('shinycssloaders')
install.packages("shinycssloaders")
runApp('Documents/R/pbplot')
library(rsconnect)
install.packages("rsconnect")
library(rsconnect)
install.packages("markdown")
rsconnect::setAccountInfo(name='gerthmicha',
token='EAB0FEB3BF3DF98D11E286B670B06725',
secret='94emQCJxm/sOa5UJP6FN2QuIU+YU5aN5RrmrtV9Y')
install.packages("optparse")
library(shiny)
shiny::runGitHub("pbplot","gerthmicha")
runApp('Documents/R/pbplot')
devtools::install_github('andrewsali/shinycssloaders')
runApp('Documents/R/pbplot')
